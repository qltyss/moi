
{% load static %}
<!DOCTYPE html>
<html lang="en">

    <head>
        <title>وزارة الداخلية</title>
        <meta charset="utf-8" />
        <link rel="icon" href="../static/assets/images/moi/moi.png" type="image/png">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

        <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
        <link rel="stylesheet" href="../static/assets/css/signin_new.css" />
        <style>
              .label {
            display: block;
        }

        .text-right {
            text-align: right;
        }

        .py-1 {
            padding-top: 0.25rem;
            padding-bottom: 0.25rem;
        }

        .rtl {
            direction: rtl;
        }
        </style>
    </head>
    <body>
        <section class="ftco-section ">
            <div class="container">
                <div class="row justify-content-center ">
                    <div class="col-md-12">
                        <div class="wrap d-md-flex">
                            <div class="text-wrap p-4 p-lg-5 d-flex img" style="background-image: url('../static/assets/images/moi/bg.png')">
                                <div class="text w-100">
                                    <!-- <h2 class="mb-4">Welcome to SDAIA</h2> -->
                                </div>
                            </div>
                            <div class="login-wrap p-md-5">
                                <div class="row  justify-content-center py-md-5">
                                    <div class="col-lg-9">

                                        <div class="social-wrap text-right pb-2 ">
                                            
                                            <img src="../static/assets/images/moi/moilogo.png" alt="" class="w-50 py-2">
                                        </div>
                                       
                                        <form action="#" method="post" class="signup-form">
                                          
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="form-group" dir="rtl">
                                                        <label class="label text-right py-1" for="email" >عنوان البريد الإلكتروني</label>
                                                        <input type="text" class="form-control" id="email_fld" value="admin@gmail.com" aria-describedby="basic-addon1" />
                                                    </div>
                                                </div>
                                                <div class="col-md-12" >
                                                    <div class="form-group " dir="rtl">
                                                        <label class="label py-2 text-end text-right float-end"  for="password">كلمة المرور</label>
                                                        <input type="password"  class="form-control" value="admin" id="password_fld"  placeholder="*************" required/>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group text-right">
                                                        <button  class="btn btn-primary btn-lg w-25" id="signin">تسجيل الدخول</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                        <div class=" w-100"  style="height: 4rem;"> 
                                            <div class="alert alert-danger" id="error" style="display: none; ">
                                                <ul>
                                                 
                                                </ul>
                                            </div>
                                        </div>
                                        

                                        
                                    </div>
                                </div>
                                <div class="row d-flex justify-content-end ">
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-10  text-right " > 
                                        <h6 class="qsspwr  py-3 ">Powered & Designed By Quality Support Solutions</h6> 
                                    </div>
                                    <div class="col-xl-2 col-lg-2 col-md-2 col-sm-2  text-start" > 
                                        <img src="../static/assets/images/moi/qssLogo.png" class="qsslogoSize pt-3">
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                        
                    </div>
                    
                </div>
                
            </div>
        </section>
    
    </body>
    <script src="../static/assets/js/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
          
             
        //   $('#signin').click(function(event) {
              
        //       event.preventDefault();

        //       // Get the values of the email and password fields
        //       var email = $('#email_fld').val();
        //       var password = $('#password_fld').val();
        //       var errorLabel = $('#error');

             
        //       if (!email || !password) {
        //           errorLabel.text('يجب ملء جميع الحقول.');
        //           return;
        //       } else {
        //           errorLabel.text('');
        //       }
        
              
        //       $.ajax({
        //           url: 'signin/', 
        //           method: 'POST',
        //           data: JSON.stringify({ email: email, password: password }),
        //           contentType: 'application/json',
        //           headers: {'X-CSRFToken': '{{ csrf_token }}'},
        //           success: function(response) {
        //               console.log(response)
        //               if (response.user) {
        //                   sessionStorage.setItem("moitoken", response.remember_token);
        //                   sessionStorage.setItem("user", JSON.stringify(response.user));
                         
        //                   localStorage.setItem('sessionToken', response.remember_token);
        //                   var user = JSON.parse(sessionStorage.getItem("user"));
        //                 console.log(user.email)
        //                 //   window.location.href = 'dashboard/'; 
        //               } else {
                       
        //                   errorLabel.text('اسم المستخدم أو كلمة المرور غير صحيحة.');
        //               }
        //           },
        //           error: function(error) {
                     
        //               errorLabel.text('حدث خطأ أثناء محاولة تسجيل الدخول. يرجى المحاولة مرة أخرى.');
        //           }
        //       });
        //   });

        $('#signin').click(function(event) {
              
              event.preventDefault();

              // Get the values of the email and password fields
              var email = $('#email_fld').val();
              var password = $('#password_fld').val();
              var errorLabel = $('#error');

             
              if (!email || !password) {
                  errorLabel.text('يجب ملء جميع الحقول.');
                  return;
              } else {
                  errorLabel.text('');
              }
        
              
              $.ajax({
                  url: 'signin/', 
                  method: 'POST',
                  data: JSON.stringify({ email: email, password: password }),
                  contentType: 'application/json',
                  headers: {'X-CSRFToken': '{{ csrf_token }}'},
                  success: function(response) {
                    // console.log(response)
                    sessionStorage.setItem("user", JSON.stringify(response));
                    window.location.href = 'dashboard/';
                  },
                  error: function(error) {
                     
                      errorLabel.text('حدث خطأ أثناء محاولة تسجيل الدخول. يرجى المحاولة مرة أخرى.');
                  }
              });
          });
      });
    </script>
</html>
